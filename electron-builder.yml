appId: com.autostory.aiwriter
productName: AutoStory
directories:
  output: dist_electron
  buildResources: build

# [추가됨] 빌드 후 압축하기 전에 실행할 스크립트 지정
afterPack: "scripts/afterPack.js"

files:
  - from: dist
    to: dist
  - package.json
  - node_modules/**/*
# 네이티브 모듈 분리 (Linux/Win/Mac 공통 이슈 방지)
asarUnpack:
  - "node_modules/@napi-rs/canvas"
  - "node_modules/playwright-core"
  - "node_modules/extract-zip"
  - "resources/**"

disableSanityCheckAsar: true
extends: null

# === Windows (GitHub Actions windows-latest에서 빌드됨) ===
win:
  target:
    - nsis
  icon: build/icon.ico
  artifactName: "${productName}-Setup-${version}.${ext}"

# === Linux (GitHub Actions ubuntu-latest에서 빌드됨) ===
linux:
  target:
    - AppImage
    - deb
  icon: build/icons
  category: Utility
  maintainer: "AutoStory Team <contact@example.com>"
  artifactName: "${productName}-${version}-linux.${ext}"
  # [삭제] chrome-sandbox 파일 제외 구문은 이제 필요 없음
  # afterPack 스크립트에서 직접 파일을 제거합니다

# === macOS (GitHub Actions macos-latest에서 빌드됨) ===
mac:
  target: dmg
  icon: build/icon.icns
  identity: null # 코드 서명 건너뛰기 (개발자 계정 없을 시 필수)
  artifactName: "${productName}-${version}-mac.${ext}"

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true

# GitHub Release로 publish 설정
publish:
  provider: github
  owner: DeclanJeon
  repo: autostory
